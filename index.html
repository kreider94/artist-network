<html>

<head>
    <script src="jquery-3.1.0.js"></script>
    <script type="text/javascript" src="main.css"></script>
    <script type="text/javascript" src="jquery-3.1.0.js"></script>
    <script type="text/javascript" src="app.js"></script>
    <script type="text/javascript" src="script.js"></script>
    <script type="text/javascript" src="mainuser.js"></script>
    <script type="text/javascript" src="sortdata.js"></script>
    <script type="text/javascript" src="positions.js"></script>
    <script type="text/javascript" src="newuser.js"></script>
    <script type="text/javascript" src="search.js"></script>
    <script src="https://connect.soundcloud.com/sdk/sdk-3.1.1.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="d3.v3.min.js"></script>

    <meta charset="utf-8">
    <style>
        .links line {
            stroke: #999;
            stroke-opacity: 0.6;
        }




        .nodes circle {
            stroke: #fff;
            stroke-width: 1.5px;
        }
    </style>
</head>

<body>

    <div id="sideNav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <div class="sidebar-image" id="dp" width="100%" height="100%"></div>
        <div class="userinfo">
            <div id="username"></div>
            <div id="description"></div>
            <div id="newuser"></div>

            <div class="infoTable">
                <tr>
                    <td>Followers</td>
                    <td>Following</td>
                    <td>Tracks</td>
                </tr>
                <td>
                    <div id="followers"></div>
                    <div id="following"></div>
                    <div id="tracks"></div>
                </td>
            </div>
        </div>
    </div>
    <div>

        <img id="login-sc" onclick="javascript:WaitForSoundcloud()" src="https://connect.soundcloud.com/2/btn-connect-sc-l.png">
        <button id="show-artists" onclick="ShowData(mainuser)" style="top:50% left:50%">SHOW YOUR FAVOURITE ARTISTS</button>
        <button id="return-graph" onclick="javascript:returnGraph()" style="top:50% left:50%">RETURN GRAPH</button>
        <span onclick="openNav()">open</span>
        <div id="mainuser"></div>

        <form id="searchsc" class="my-form">
            <input id="searchval" type="search" name="searchbar">
            <input id="submit" type="button" onclick="javascript:search()" value="search">
        </form>

        <script type="text/javascript">
            function makeNetwork(graph) {
                var width = 800,
                    height = 800;

                var color = d3.scale.category20();

                var force = d3.layout.force()
                    .charge(-300)
                    .linkDistance(100)
                    .size([width, height]);

                var svg = d3.select("body").append("svg")
                    .attr("width", "100%")
                    .attr("height", "100%");

                var nodes = graph.nodes;
                var links = graph.links;
                console.log(nodes);
                console.log(links);
                force
                    .nodes(nodes)
                    .links(links)
                    .start();

                var link = svg.selectAll(".link")
                    .data(links)
                    .enter().append("line")
                    .attr("class", "link")
                    .style("stroke-width", function(d) {
                        console.log(d.target);
                        return d.target;
                    })
                    .style("stroke", function(d) {
                        return color(d.value)
                    });;

                var gnodes = svg.selectAll('g.gnode') //('g.gnode')
                    .data(nodes)
                    .enter()
                    .append('g')
                    .classed('gnode', true)


                // var node = gnodes.append("circle")
                //     .attr('x', -9)
                //     .attr('y', -19)
                //     .attr("r", 10)
                //     .attr("xlink:href", function(d) {
                //         return d.avatar;
                //     })
                //     .on("mouseover", function(d) {
                //         d3.select(labels[0][d.index]).style("visibility", "visible")
                //     })
                //     .on("mouseout", function(d) {
                //         d3.select(labels[0][d.index]).style("visibility", "hidden")
                //     })
                // .call(force.drag);

                var labels = gnodes.append("text")
                    .text(function(d) {
                        return d.username;
                    });

                var defs = gnodes.append("defs").attr("id", "imgdefs")

                var image = gnodes.append("pattern")
                    .attr("id", "image")
                    .attr("height", 30)
                    .attr("width", 30)
                    .attr("x", "0")
                    .attr("y", "0")
                image.append("image")
                    .attr("height", 30)
                    .attr("width", 30)
                    .attr("xlink:href", function(d) {
                        return d.avatar;
                    });

                var node = gnodes.append("circle")
                    .attr("r", 15)
                    .attr("fill", "url(#image)").call(force.drag);

                force.on("tick", function() {
                    link.attr("x1", function(d) {
                            return d.source.x;
                        })
                        .attr("y1", function(d) {
                            return d.source.y;
                        })
                        .attr("x2", function(d) {
                            return d.target.x;
                        })
                        .attr("y2", function(d) {
                            return d.target.y;
                        });

                    gnodes.attr("transform", function(d) {
                        return 'translate(' + [d.x, d.y] + ')';
                    });
                });

                function dragstarted(d) {
                    if (!d3.event.active) simulation.alphaTarget(0.3).restart();
                    d.fx = d.x;
                    d.fy = d.y;
                }

                function dragged(d) {
                    d.fx = d3.event.x;
                    d.fy = d3.event.y;
                }

                function dragended(d) {
                    if (!d3.event.active) simulation.alphaTarget(0);
                    d.fx = null;
                    d.fy = null;
                }

            }
        </script>

</html>
</body>
